<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-04-24 Mon 07:07 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>10. Input and Output</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Paul Gribble" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="mystyle.css" /><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-52544521-1', 'auto');ga('send', 'pageview');</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="http://www.gribblelab.org/CBootCamp/index.html"> UP </a>
 |
 <a accesskey="H" href="http://www.gribblelab.org/CBootCamp/index.html"> HOME </a>
</div><div id="content">
<h1 class="title">10. Input and Output</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org9a73bb0">Command-line arguments</a></li>
<li><a href="#org1aeb5a8">I/O Streams</a>
<ul>
<li><a href="#org306eec5">Character I/O: <code>getchar()</code> and <code>putchar()</code></a></li>
<li><a href="#org99a0fed">Formatted I/O: <code>printf()</code> and <code>scanf()</code></a>
<ul>
<li><a href="#orge929f64">The <code>printf()</code> function</a></li>
<li><a href="#orgfffc8af">The <code>scanf()</code> function</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgedd2685">Input and Output with Files</a>
<ul>
<li><a href="#org88ad148">Opening and Closing files with <code>fopen()</code> and <code>fclose()</code></a></li>
<li><a href="#org11dd4bc">Reading and Writing to files</a>
<ul>
<li><a href="#org4927758">Ascii Files (plain text)</a></li>
<li><a href="#orgc9d0743">Binary Files (raw bytes)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6b82d99">Links</a></li>
<li><a href="#org1a77520">Exercises</a>
<ul>
<li><a href="#orgde4e54e">Solutions</a></li>
</ul>
</li>
</ul>
</div>
</div>
<hr />

<div id="outline-container-org9a73bb0" class="outline-2">
<h2 id="org9a73bb0">Command-line arguments</h2>
<div class="outline-text-2" id="text-org9a73bb0">
<p>
When you run a C program from the command line, you can pass it input
arguments.
</p>
</div>
</div>


<div id="outline-container-org1aeb5a8" class="outline-2">
<h2 id="org1aeb5a8">I/O Streams</h2>
<div class="outline-text-2" id="text-org1aeb5a8">
<p>
The standard C library (linked to using <code>#include &lt;stdio.h&gt;</code>)
includes a handful of functions for performing input and output in C.
</p>

<p>
C and UNIX make use of a concept called <b>streams</b> in which data can be
sent and received between programs, devices, and the operating
system. We can distinguish between two types of streams: text and
binary.
</p>

<p>
Text streams are made up of lines, where each line has zero or more
characters, and is terminated by a new-line character <code>\n</code>. Binary
streams are more "raw" and consist of a stream of any number of bytes.
</p>

<p>
C programs all have three streams "built-in": <b>standard input</b>,
<b>standard output</b>, and <b>standard error</b>. When you interact with a C
program in a terminal, and you type values in, you are using standard
input.
</p>

<p>
UNIX has a concept called <b>pipes</b> (e.g. see <a href="http://en.wikipedia.org/wiki/Pipeline_(Unix)">here</a>) whereby you can
redirect any stream (e.g. output from some program or device) as input
to another process (e.g. your program). When you redirect a stream to
your program, which takes it in as input, you are using the standard
input stream.
</p>

<p>
When your program uses <code>printf()</code> (see below) to print to the screen, you are using <b>standard output</b>.
</p>

<p>
Files (e.g. data files) are also associated with streams, and we will see below how to read from them and write to them.
</p>

<p>
We won't talk about <b>standard error</b> here. Refer to a UNIX reference,
a C book, or <a href="http://www.acm.uiuc.edu/webmonkeys/book/c_guide/2.12.html#streams%5C">Streams and Files</a> for more details.
</p>
</div>

<div id="outline-container-org306eec5" class="outline-3">
<h3 id="org306eec5">Character I/O: <code>getchar()</code> and <code>putchar()</code></h3>
<div class="outline-text-3" id="text-org306eec5">
<p>
When you want to read data a single character at a time, you can use
<code>getchar()</code>. The output function <code>putchar()</code> will write out one
character at a time to standard output.
</p>

<div class="org-src-container">
<pre class="src src-C"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">()</span> <span style="color: #4f97d7;">{</span>
  <span style="color: #ce537a; font-weight: bold;">char</span> <span style="color: #7590db;">c</span> = getchar<span style="color: #bc6ec5;">()</span>;
  putchar<span style="color: #bc6ec5;">(</span>c<span style="color: #bc6ec5;">)</span>;
  putchar<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">'\n'</span><span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">0</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<pre class="example">
x
x
</pre>
</div>
</div>

<div id="outline-container-org99a0fed" class="outline-3">
<h3 id="org99a0fed">Formatted I/O: <code>printf()</code> and <code>scanf()</code></h3>
<div class="outline-text-3" id="text-org99a0fed">
</div><div id="outline-container-orge929f64" class="outline-4">
<h4 id="orge929f64">The <code>printf()</code> function</h4>
<div class="outline-text-4" id="text-orge929f64">
<p>
We have seen in many of the example code snippets, the use of the
<code>printf()</code> function to write formatted output to the screen. In
general the <code>printf()</code> function takes two arguments: first, a string
argument that indicates what to write to the screen, including
formats, and second, a list of variables that provide the data to the
various elements in the formatting string.
</p>

<p>
Here is an example where we print a sentence that contains a formatted integer, a floating-point number, and a string:
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">()</span> <span style="color: #4f97d7;">{</span>
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span> = <span style="color: #a45bad;">42</span>;
  <span style="color: #ce537a; font-weight: bold;">char</span> <span style="color: #7590db;">str</span><span style="color: #bc6ec5;">[]</span> = <span style="color: #2d9574;">"the meaning of life"</span>;
  <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">p</span> = <span style="color: #a45bad;">3.14159265</span>;
  printf<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"pi is about %12.8f and %s is %d\n"</span>, p, str, i<span style="color: #bc6ec5;">)</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<pre class="example">
pi is about   3.14159265 and the meaning of life is 42
</pre>

<p>
Let's unpack the <code>printf()</code> statement above on line 7. The format
string includes three numeric format codes. The first, <code>%12.8f</code>, says
that we want to print a floating-point number (<code>f</code>), we want to print
it to 8 decimal places (<code>.8</code>), and we want to provide 12 columns of
space for it (<code>12</code>). The second format argument is <code>%s</code> which
corresponds to a string. The third format argument is <code>%d</code> which
corresponds to an integer.
</p>

<p>
Consult a reference manual (or a website like <a href="http://www.acm.uiuc.edu/webmonkeys/book/c_guide/2.12.html#printf">this</a> for full details).
</p>
</div>
</div>

<div id="outline-container-orgfffc8af" class="outline-4">
<h4 id="orgfffc8af">The <code>scanf()</code> function</h4>
<div class="outline-text-4" id="text-orgfffc8af">
<p>
To read formatted data in from standard input we can use the
<code>fscanf()</code> function. Just like <code>printf()</code>, it takes as a first
argument a format string, followed by other arguments specifying the
destination of each argument. Unlike <code>printf()</code>, the <code>scanf()</code>
function requires that these destination arguments be <b>addresses</b> of
the relevant locations in memory (we can feed it a pointer, for
example).
</p>

<p>
Here is a simple example in which we read from standard input a date,
which we expect to be in the following format:
</p>

<pre class="example">
25 Dec 2012
</pre>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">()</span> <span style="color: #4f97d7;">{</span>
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">day</span>, <span style="color: #7590db;">year</span>;
  <span style="color: #ce537a; font-weight: bold;">char</span> <span style="color: #7590db;">monthname</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">20</span><span style="color: #bc6ec5;">]</span>;
  scanf<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"%d %s %d"</span>, &amp;day, monthname, &amp;year<span style="color: #bc6ec5;">)</span>;
  printf<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"the date is %s %d, %d\n"</span>, monthname, day, year<span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">0</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<pre class="example">
25 Dec 2012
the date is Dec 25, 2012
</pre>

<p>
Note how on line 6, we pass the <b>address</b> of <code>day</code> and <code>year</code> using
the ampersand (<code>&amp;</code>) operator. On line 4 we declare <code>day</code> and <code>year</code> as
<code>int</code>. Using the ampersand notation, we can write <code>&amp;day</code> and <code>&amp;year</code>,
which correspond to <b>pointers</b> to the <b>address</b> of <code>day</code> and <code>year</code>.
</p>

<p>
The <code>scanf()</code> function ignores blanks and tabs in the format string,
and it skips over white space (blanks, tabs, newlines, etc) as it
looks for input values.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-orgedd2685" class="outline-2">
<h2 id="orgedd2685">Input and Output with Files</h2>
<div class="outline-text-2" id="text-orgedd2685">
</div><div id="outline-container-org88ad148" class="outline-3">
<h3 id="org88ad148">Opening and Closing files with <code>fopen()</code> and <code>fclose()</code></h3>
<div class="outline-text-3" id="text-org88ad148">
<p>
Before a file can be read or written to, it has to be <b>opened</b> using
the <code>fopen()</code> function, which takes as arguments a string
corresponding to the filename, and a second argument (also a string)
corresponding to the <b>mode</b>. The mode is read ("r"), write ("w") or
append ("a"). The <code>fopen()</code> function then returns a pointer to the
(open) file. After reading and/or writing to your file, you will need
to <b>close</b> it using the <code>fclose()</code> function.
</p>
</div>
</div>

<div id="outline-container-org11dd4bc" class="outline-3">
<h3 id="org11dd4bc">Reading and Writing to files</h3>
<div class="outline-text-3" id="text-org11dd4bc">
<p>
There are many functions in <code>stdio.h</code> for reading from and writing to
files. There is a collection of functions for reading and writing ascii (text) data, and there are functions for dealing with binary data.
</p>
</div>

<div id="outline-container-org4927758" class="outline-4">
<h4 id="org4927758">Ascii Files (plain text)</h4>
<div class="outline-text-4" id="text-org4927758">
<p>
There are functions to read single characters at a time (<code>getc()</code> and
<code>putc()</code>), there are functions to read and write formatted output
(<code>fscanf()</code> and <code>fprintf()</code>), and there are functions to read and
write single lines at a time (<code>fgets()</code> and <code>fputs()</code>).
</p>

<p>
Here is an example program that outputs a table of temperature values in Fahrenheit and Celsius to an ascii file.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">argc</span>, <span style="color: #ce537a; font-weight: bold;">char</span> *<span style="color: #7590db;">argv</span><span style="color: #bc6ec5;">[]</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">{</span>

  <span style="color: #ce537a; font-weight: bold;">FILE</span> *<span style="color: #7590db;">fp</span>;
  <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">tmpC</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">11</span><span style="color: #bc6ec5;">]</span> = <span style="color: #bc6ec5;">{</span>-<span style="color: #a45bad;">10.0</span>, -<span style="color: #a45bad;">8.0</span>, -<span style="color: #a45bad;">6.0</span>,
          -<span style="color: #a45bad;">4.0</span>, -<span style="color: #a45bad;">2.0</span>,  <span style="color: #a45bad;">0.0</span>,  <span style="color: #a45bad;">2.0</span>,
           <span style="color: #a45bad;">4.0</span>,  <span style="color: #a45bad;">6.0</span>,  <span style="color: #a45bad;">8.0</span>, <span style="color: #a45bad;">10.0</span><span style="color: #bc6ec5;">}</span>;
  <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">tmpF</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">i</span>;

  fp = fopen<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"outfile.txt"</span>, <span style="color: #2d9574;">"w"</span><span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>fp == <span style="color: #a45bad;">NULL</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span>
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"sorry can't open outfile.txt\n"</span><span style="color: #2d9574;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">1</span>;
  <span style="color: #bc6ec5;">}</span>
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">print a table header</span>
    fprintf<span style="color: #2d9574;">(</span>fp, <span style="color: #2d9574;">"%10s %10s\n"</span>, <span style="color: #2d9574;">"Celsius"</span>, <span style="color: #2d9574;">"Fahrenheit"</span><span style="color: #2d9574;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">for</span> <span style="color: #2d9574;">(</span>i=<span style="color: #a45bad;">0</span>; i&lt;<span style="color: #a45bad;">11</span>; i++<span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span>
      tmpF = <span style="color: #67b11d;">(</span><span style="color: #b1951d;">(</span>tmpC<span style="color: #4f97d7;">[</span>i<span style="color: #4f97d7;">]</span> * <span style="color: #4f97d7;">(</span><span style="color: #a45bad;">9.0</span>/<span style="color: #a45bad;">5.0</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> + <span style="color: #a45bad;">32.0</span><span style="color: #67b11d;">)</span>;
      fprintf<span style="color: #67b11d;">(</span>fp, <span style="color: #2d9574;">"%10.2f %10.2f\n"</span>, tmpC<span style="color: #b1951d;">[</span>i<span style="color: #b1951d;">]</span>, tmpF<span style="color: #67b11d;">)</span>;
    <span style="color: #2d9574;">}</span>
    fclose<span style="color: #2d9574;">(</span>fp<span style="color: #2d9574;">)</span>;
  <span style="color: #bc6ec5;">}</span>

  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">0</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<pre class="example">
plg@wildebeest:~/Desktop$ more outfile.txt 
   Celsius Fahrenheit
    -10.00      14.00
     -8.00      17.60
     -6.00      21.20
     -4.00      24.80
     -2.00      28.40
      0.00      32.00
      2.00      35.60
      4.00      39.20
      6.00      42.80
      8.00      46.40
     10.00      50.00
</pre>

<p>
A couple of things are worth noting about the code above. On line 13,
we check the value of the file pointer <code>fp</code>, and if it is equal to
<code>NULL</code> (which means there was an error opening the file), we write a
message to the screen and we <code>return 1</code> (which exits the <code>main()</code>
function and thus exits our program). A convention in UNIX is that
programs which execute successfully return <code>0</code> and non-zero values are
returned when there was an error encountered.
</p>

<p>
On lines 19 and 22 we use the <code>fprintf()</code> function to write to the
file. This is just like the <code>printf()</code> function that we have seen
before, to write formatted output to standard output. This time we're
writing to a file instead.
</p>

<p>
To illustrate reading from ascii files, here's an example program that
will read in the file produced by the previous code example, and do
some arithmetic on them.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">argc</span>, <span style="color: #ce537a; font-weight: bold;">char</span> *<span style="color: #7590db;">argv</span><span style="color: #bc6ec5;">[]</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">{</span>

  <span style="color: #ce537a; font-weight: bold;">FILE</span> *<span style="color: #7590db;">fp</span>;
  <span style="color: #ce537a; font-weight: bold;">char</span> <span style="color: #7590db;">buffer</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">256</span><span style="color: #bc6ec5;">]</span>;
  <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">tempC</span>, <span style="color: #7590db;">tempF</span>;
  <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">sumC</span> = <span style="color: #a45bad;">0.0</span>;
  <span style="color: #ce537a; font-weight: bold;">double</span> <span style="color: #7590db;">sumF</span> = <span style="color: #a45bad;">0.0</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">numread</span> = <span style="color: #a45bad;">0</span>;

  fp = fopen<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"outfile.txt"</span>, <span style="color: #2d9574;">"r"</span><span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>fp == <span style="color: #a45bad;">NULL</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span>
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"there was an error opening outfile.txt\n"</span><span style="color: #2d9574;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">1</span>;
  <span style="color: #bc6ec5;">}</span>
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">read in the header line first</span>
    fgets<span style="color: #2d9574;">(</span>buffer, <span style="color: #a45bad;">256</span>, fp<span style="color: #2d9574;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">while</span> <span style="color: #2d9574;">(</span><span style="color: #a45bad;">!</span>feof<span style="color: #67b11d;">(</span>fp<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #2d9574;">{</span>
      fscanf<span style="color: #67b11d;">(</span>fp, <span style="color: #2d9574;">"%lf %lf\n"</span>, &amp;tempC, &amp;tempF<span style="color: #67b11d;">)</span>;
      printf<span style="color: #67b11d;">(</span><span style="color: #2d9574;">"tempC=%.2f, tempF=%.2f\n"</span>, tempC, tempF<span style="color: #67b11d;">)</span>;
      sumC += tempC;
      sumF += tempF;
      numread++;
    <span style="color: #2d9574;">}</span>
    fclose<span style="color: #2d9574;">(</span>fp<span style="color: #2d9574;">)</span>;
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"%d values read, sumC=%.2f and sumF=%.2f\n"</span>, numread, sumC, sumF<span style="color: #2d9574;">)</span>;
  <span style="color: #bc6ec5;">}</span>

  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">0</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<pre class="example">
tempC=-10.00, tempF=14.00
tempC=-8.00, tempF=17.60
tempC=-6.00, tempF=21.20
tempC=-4.00, tempF=24.80
tempC=-2.00, tempF=28.40
tempC=0.00, tempF=32.00
tempC=2.00, tempF=35.60
tempC=4.00, tempF=39.20
tempC=6.00, tempF=42.80
tempC=8.00, tempF=46.40
tempC=10.00, tempF=50.00
11 values read, sumC=0.00 and sumF=352.00
</pre>

<p>
Some comments about the above code example: on line 19 we use the
<code>fgets()</code> function to read in the first line of the file to a
character string (<code>buffer</code>) that we declared above. The <code>fgets()</code>
function requires as its second argument the maximum number of
characters to read. Since we know we don't expect many here, we
indicate a maximum of 256. After reading in the first line, we now
enter a <b>while loop</b>, using <code>fscanf()</code> to read in each pair of
floating-point values. The while loop terminates when <code>!feof(fp)</code> is
false. The <code>feof()</code> function returns TRUE if we are at the end of the
file, and FALSE otherwise.
</p>
</div>
</div>

<div id="outline-container-orgc9d0743" class="outline-4">
<h4 id="orgc9d0743">Binary Files (raw bytes)</h4>
<div class="outline-text-4" id="text-orgc9d0743">
<p>
There are many circumstances in which you may want to read from and
write to binary files. Binary files are not plain text (ascii) files
where each chunk of bytes represents an ascii character. In binary
files, you store raw bytes, in whatever format you want. For example
Optotrak stores its data files as binary files: a header of a given
length (number of bytes) followed by data, in a specific byte format.
</p>

<p>
Advantages of binary files over ascii files is that they are typically
smaller in size, and they can be read from and written to faster (no
need to convert between raw bytes and ascii characters). Disadvantages
of binary files are that they are not human readable (you can't open
in them in a text editor and "look" at them).
</p>

<p>
The <code>fread()</code> and <code>fwrite()</code> functions are used to read and write
binary data (raw bytes) from and to binary files. Here is an example
of writing some data to a binary file. We first write a 16 byte header
containing the date (4 + 4 + 4 = 12 bytes) and the number of data
points (4 bytes). We then write out the data array, 4 bytes per
element. In this example the data are integer values.
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">argc</span>, <span style="color: #ce537a; font-weight: bold;">char</span> *<span style="color: #7590db;">argv</span><span style="color: #bc6ec5;">[]</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">{</span>

  <span style="color: #ce537a; font-weight: bold;">FILE</span> *<span style="color: #7590db;">fp</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">year</span> = <span style="color: #a45bad;">2012</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">month</span> = <span style="color: #a45bad;">8</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">day</span> = <span style="color: #a45bad;">26</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">mydata</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">5</span><span style="color: #bc6ec5;">]</span> = <span style="color: #bc6ec5;">{</span><span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">4</span>, <span style="color: #a45bad;">6</span>, <span style="color: #a45bad;">8</span>, <span style="color: #a45bad;">10</span><span style="color: #bc6ec5;">}</span>;

  fp = fopen<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"data.bin"</span>, <span style="color: #2d9574;">"w"</span><span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>fp == <span style="color: #a45bad;">NULL</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span>
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"error opening data.bin\n"</span><span style="color: #2d9574;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">1</span>;
  <span style="color: #bc6ec5;">}</span>
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">write out the header</span>
    <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">bytesout</span>;
    bytesout = fwrite<span style="color: #2d9574;">(</span>&amp;year, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span>year<span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">1</span>, fp<span style="color: #2d9574;">)</span>;
    bytesout = fwrite<span style="color: #2d9574;">(</span>&amp;month, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span>month<span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">1</span>, fp<span style="color: #2d9574;">)</span>;
    bytesout = fwrite<span style="color: #2d9574;">(</span>&amp;day, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span>day<span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">1</span>, fp<span style="color: #2d9574;">)</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">write the data</span>
    bytesout = fwrite<span style="color: #2d9574;">(</span>mydata, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span><span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">5</span>, fp<span style="color: #2d9574;">)</span>;
    fclose<span style="color: #2d9574;">(</span>fp<span style="color: #2d9574;">)</span>;
  <span style="color: #bc6ec5;">}</span>

  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">0</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<p>
Here is an example program to read from the binary data file:
</p>

<div class="org-src-container">
<pre class="src src-c"><span style="color: #bc6ec5;">#include</span> <span style="color: #4f97d7;">&lt;</span><span style="color: #2d9574;">stdio.h</span><span style="color: #4f97d7;">&gt;</span>

<span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">argc</span>, <span style="color: #ce537a; font-weight: bold;">char</span> *<span style="color: #7590db;">argv</span><span style="color: #bc6ec5;">[]</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">{</span>

  <span style="color: #ce537a; font-weight: bold;">FILE</span> *<span style="color: #7590db;">fp</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">bytesread</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">yy</span>, <span style="color: #7590db;">mm</span>, <span style="color: #7590db;">dd</span>;
  <span style="color: #ce537a; font-weight: bold;">int</span> <span style="color: #7590db;">thedata</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">5</span><span style="color: #bc6ec5;">]</span>;

  fp = fopen<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"data.bin"</span>, <span style="color: #2d9574;">"r"</span><span style="color: #bc6ec5;">)</span>;
  <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>fp == <span style="color: #a45bad;">NULL</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span>
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"error opening data.bin\n"</span><span style="color: #2d9574;">)</span>;
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">1</span>;
  <span style="color: #bc6ec5;">}</span>
  <span style="color: #4f97d7; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span>
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">read the header</span>
    bytesread = fread<span style="color: #2d9574;">(</span>&amp;yy, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span><span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">1</span>, fp<span style="color: #2d9574;">)</span>;
    bytesread = fread<span style="color: #2d9574;">(</span>&amp;mm, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span><span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">1</span>, fp<span style="color: #2d9574;">)</span>;
    bytesread = fread<span style="color: #2d9574;">(</span>&amp;dd, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span><span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">1</span>, fp<span style="color: #2d9574;">)</span>;
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"year=%d, month=%d, day=%d\n"</span>, yy, mm, dd<span style="color: #2d9574;">)</span>;
    <span style="color: #2aa1ae; background-color: #292e34;">// </span><span style="color: #2aa1ae; background-color: #292e34;">read the data</span>
    bytesread = fread<span style="color: #2d9574;">(</span>thedata, <span style="color: #4f97d7; font-weight: bold;">sizeof</span><span style="color: #67b11d;">(</span><span style="color: #ce537a; font-weight: bold;">int</span><span style="color: #67b11d;">)</span>, <span style="color: #a45bad;">5</span>, fp<span style="color: #2d9574;">)</span>;
    printf<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"data = [%d,%d,%d,%d,%d]\n"</span>,
     thedata<span style="color: #67b11d;">[</span><span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span>, thedata<span style="color: #67b11d;">[</span><span style="color: #a45bad;">1</span><span style="color: #67b11d;">]</span>,thedata<span style="color: #67b11d;">[</span><span style="color: #a45bad;">2</span><span style="color: #67b11d;">]</span>,thedata<span style="color: #67b11d;">[</span><span style="color: #a45bad;">3</span><span style="color: #67b11d;">]</span>,thedata<span style="color: #67b11d;">[</span><span style="color: #a45bad;">4</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">)</span>; 
    fclose<span style="color: #2d9574;">(</span>fp<span style="color: #2d9574;">)</span>;
  <span style="color: #bc6ec5;">}</span>

  <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">0</span>;
<span style="color: #4f97d7;">}</span>
</pre>
</div>

<pre class="example">
year=2012, month=8, day=26
data = [2,4,6,8,10]
</pre>

<p>
The bottom line is, as long as you know what the binary <b>format</b> is
(that is, how many bytes represent each value) then you can read and
write them in "raw" binary using <code>fread()</code> and <code>fwrite()</code>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org6b82d99" class="outline-2">
<h2 id="org6b82d99">Links</h2>
<div class="outline-text-2" id="text-org6b82d99">
<ul class="org-ul">
<li><a href="http://www.acm.uiuc.edu/webmonkeys/book/c_guide/index.html">The C Library Reference Guide</a></li>
<li><a href="http://en.wikipedia.org/wiki/C_file_input/output">C file input/output</a></li>
</ul>
</div>
</div>


<div id="outline-container-org1a77520" class="outline-2">
<h2 id="org1a77520">Exercises</h2>
<div class="outline-text-2" id="text-org1a77520">
<ul class="org-ul">
<li>1 Write a program that asks the user to enter three strings. After
they have entered all three strings, print the strings out using all
uppercase letters.</li>

<li>2 Alter the program so that it prints out the all-caps strings in reverse.</li>

<li>3 Alter the program again so that it writes the all-caps reversed
strings to a plaintext file.</li>

<li>4 Write a program that reads three strings from a plaintext file,
reverses each string, and prints them out to the screen.</li>
</ul>
</div>


<div id="outline-container-orgde4e54e" class="outline-3">
<h3 id="orgde4e54e">Solutions</h3>
<div class="outline-text-3" id="text-orgde4e54e">
<ul class="org-ul">
<li>x</li>
<li>x</li>
<li>x</li>
<li>x</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr />Paul Gribble | Summer 2012<br>This <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" rel="dct:type">work</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a><br><a rel="license"href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />
</div>
</body>
</html>
